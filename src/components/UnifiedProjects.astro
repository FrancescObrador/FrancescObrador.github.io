---
import { getCollection } from "astro:content";
import { getLangFromUrl } from "../i18n/utils";
import ProjectCard from "./ProjectCard.astro";
import ProjectFilters from "./ProjectFilters.astro";

const lang = getLangFromUrl(Astro.url);
const projects = await getCollection("projects", ({ id }) => {
    return id.startsWith(`${lang}/`);
});

// Sort projects - maybe work first
const sortedProjects = projects.sort((a, b) => {
    if (a.data.type === "work" && b.data.type !== "work") return -1;
    if (a.data.type !== "work" && b.data.type === "work") return 1;
    return 0;
});
---

<div class="space-y-12">
    <ProjectFilters />

    <div class="flex flex-col gap-y-12">
        {sortedProjects.map((project) => <ProjectCard {...project.data} />)}
    </div>
</div>
